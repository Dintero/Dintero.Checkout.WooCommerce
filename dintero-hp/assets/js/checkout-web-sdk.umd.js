!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e=e||self).dintero={})}(this,function(e){var n,t,o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};!function(e){var n;(n=o).Promise=n.Promise||function(){var e,n,t,o=Object.prototype.toString,i="undefined"!=typeof setImmediate?function(e){return setImmediate(e)}:setTimeout;try{Object.defineProperty({},"x",{}),e=function(e,n,t,o){return Object.defineProperty(e,n,{value:t,writable:!0,configurable:!1!==o})}}catch(n){e=function(e,n,t){return e[n]=t,e}}function r(e,o){t.add(e,o),n||(n=i(t.drain))}function s(e){var n,t=typeof e;return null==e||"object"!=t&&"function"!=t||(n=e.then),"function"==typeof n&&n}function a(){for(var e=0;e<this.chain.length;e++)c(this,1===this.state?this.chain[e].success:this.chain[e].failure,this.chain[e]);this.chain.length=0}function c(e,n,t){var o,i;try{!1===n?t.reject(e.msg):(o=!0===n?e.msg:n.call(void 0,e.msg))===t.promise?t.reject(TypeError("Promise-chain cycle")):(i=s(o))?i.call(o,t.resolve,t.reject):t.resolve(o)}catch(e){t.reject(e)}}function u(e){var n,t=this;if(!t.triggered){t.triggered=!0,t.def&&(t=t.def);try{(n=s(e))?r(function(){var o=new h(t);try{n.call(e,function(){u.apply(o,arguments)},function(){f.apply(o,arguments)})}catch(e){f.call(o,e)}}):(t.msg=e,t.state=1,t.chain.length>0&&r(a,t))}catch(e){f.call(new h(t),e)}}}function f(e){var n=this;n.triggered||(n.triggered=!0,n.def&&(n=n.def),n.msg=e,n.state=2,n.chain.length>0&&r(a,n))}function d(e,n,t,o){for(var i=0;i<n.length;i++)!function(i){e.resolve(n[i]).then(function(e){t(i,e)},o)}(i)}function h(e){this.def=e,this.triggered=!1}function l(e){this.promise=e,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function p(e){if("function"!=typeof e)throw TypeError("Not a function");if(0!==this.__NPO__)throw TypeError("Not a promise");this.__NPO__=1;var n=new l(this);this.then=function(e,t){var o={success:"function"!=typeof e||e,failure:"function"==typeof t&&t};return o.promise=new this.constructor(function(e,n){if("function"!=typeof e||"function"!=typeof n)throw TypeError("Not a function");o.resolve=e,o.reject=n}),n.chain.push(o),0!==n.state&&r(a,n),o.promise},this.catch=function(e){return this.then(void 0,e)};try{e.call(void 0,function(e){u.call(n,e)},function(e){f.call(n,e)})}catch(e){f.call(n,e)}}t=function(){var e,t,o;function i(e,n){this.fn=e,this.self=n,this.next=void 0}return{add:function(n,r){o=new i(n,r),t?t.next=o:e=o,t=o,o=void 0},drain:function(){var o=e;for(e=t=n=void 0;o;)o.fn.call(o.self),o=o.next}}}();var y=e({},"constructor",p,!1);return p.prototype=y,e(y,"__NPO__",0,!1),e(p,"resolve",function(e){return e&&"object"==typeof e&&1===e.__NPO__?e:new this(function(n,t){if("function"!=typeof n||"function"!=typeof t)throw TypeError("Not a function");n(e)})}),e(p,"reject",function(e){return new this(function(n,t){if("function"!=typeof n||"function"!=typeof t)throw TypeError("Not a function");t(e)})}),e(p,"all",function(e){var n=this;return"[object Array]"!=o.call(e)?n.reject(TypeError("Not an array")):0===e.length?n.resolve([]):new n(function(t,o){if("function"!=typeof t||"function"!=typeof o)throw TypeError("Not a function");var i=e.length,r=Array(i),s=0;d(n,e,function(e,n){r[e]=n,++s===i&&t(r)},o)})}),e(p,"race",function(e){var n=this;return"[object Array]"!=o.call(e)?n.reject(TypeError("Not an array")):new n(function(t,o){if("function"!=typeof t||"function"!=typeof o)throw TypeError("Not a function");d(n,e,function(e,n){t(n)},o)})}),p}(),e.exports&&(e.exports=n.Promise)}({path:void 0,exports:{},require:function(e,n){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}}),function(e){e.SessionNotFound="SessionNotFound",e.SessionLoaded="SessionLoaded",e.SessionUpdated="SessionUpdated",e.SessionCancel="SessionCancel",e.SessionPaymentOnHold="SessionPaymentOnHold",e.SessionPaymentAuthorized="SessionPaymentAuthorized",e.SessionPaymentError="SessionPaymentError",e.SessionLocked="SessionLocked",e.SessionLockFailed="SessionLockFailed"}(n||(n={})),function(e){e.HeightChanged="HeightChanged",e.LanguageChanged="LanguageChanged"}(t||(t={}));var i=function(e){window.location.assign(e)},r=function(e){var n=e.sid,t=e.endpoint,o=e.language,i=e.ui;if(!t)throw new Error("Invalid endpoint");var r=[o?"language="+o:"",i?"ui="+i:"","sdk=0.0.15"].filter(function(e){return e}).join("&");return t+"/v1/view/"+n+(r?"?"+r:"")},s=function(e){e.href&&i(e.href)},a=function(e,n){(e.height||0===e.height)&&n.iframe.setAttribute("style","width:100%; height:"+e.height+"px;")},c=function(e,n){e.language&&(n.language=e.language)},u=function(e,t,o){return function(e,i){var r=["sid","merchant_reference","transaction_id","error"].map(function(n){return[n,e[n]]});e.type!==n.SessionCancel||e.error||r.push(["error","cancelled"]),r.push(["language",i.language]),r.push(["sdk","0.0.15"]);var s=r.filter(function(e){return e[1]}).map(function(e){return e[0]+"="+e[1]}).join("&");i.iframe.setAttribute("src",t+"/embedResult/?"+s),o(e,i)}};e.embed=function(e){try{var o=e.container,i=e.sid,f=e.language,d=e.endpoint,h=void 0===d?"https://checkout.dintero.com":d,l=e.onSession,p=e.onSessionCancel,y=e.onPayment,g=e.onPaymentAuthorized,m=e.onPaymentError,v=e.onSessionNotFound,w=e.onSessionLocked,S=e.onSessionLockFailed,b=[];return Promise.resolve(function(e,n,t){if(!e||!e.appendChild)throw new Error("Invalid container");var o=document.createElement("iframe");return o.setAttribute("frameborder","0"),o.setAttribute("allowTransparency","true"),o.setAttribute("style","width:100%; height:0;"),o.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups"),o.setAttribute("importance","high"),o.setAttribute("src",t),{iframe:o,initiate:function(){try{return Promise.resolve(new Promise(function(n,t){o.onload=function(){return n()},o.onerror=function(){return t()},e.appendChild(o)}))}catch(e){return Promise.reject(e)}}}}(o,0,r({sid:i,endpoint:h,language:f,ui:"inline"}))).then(function(e){var r=e.iframe,d=e.initiate,P={destroy:function(){r&&(b.forEach(function(e){return e.unsubscribe()}),r.parentElement&&o.removeChild(r))},iframe:r,language:f,lockSession:function(){!function(e,n){e.contentWindow&&e.contentWindow.postMessage({type:"LockSession",sid:n},"*")}(r,i)},refreshSession:function(){!function(e,n){e.contentWindow&&e.contentWindow.postMessage({type:"RefreshSession",sid:n},"*")}(r,i)}};return[{handler:c,eventTypes:[t.LanguageChanged]},{handler:a,eventTypes:[t.HeightChanged]},{handler:l,eventTypes:[n.SessionLoaded,n.SessionUpdated]},{eventTypes:[n.SessionPaymentOnHold],handler:y?u(0,h,y):s},{eventTypes:[n.SessionPaymentAuthorized],handler:g||y?u(0,h,g||y):s},{handler:p?u(0,h,p):s,eventTypes:[n.SessionCancel]},{handler:m?u(0,h,m):s,eventTypes:[n.SessionPaymentError]},{handler:v,eventTypes:[n.SessionNotFound]},{handler:w,eventTypes:[n.SessionLocked]},{handler:S,eventTypes:[n.SessionLockFailed]}].forEach(function(e){var n=e.handler;n&&b.push(function(e){var n=e.sid,t=e.endpoint,o=e.handler,i=e.eventTypes,r=e.checkout,s=function(e){var s=e.origin===t,a=e.source===r.iframe.contentWindow,c=e.data&&e.data.sid===n,u=-1!==i.indexOf(e.data&&e.data.type);s&&a&&c&&u&&(function(e,n){n.data.mid&&e.contentWindow&&e.contentWindow.postMessage({ack:n.data.mid},n.origin||"*")}(r.iframe,e),o(e.data,r))};return window.addEventListener("message",s,!1),{unsubscribe:function(){window.removeEventListener("message",s,!1)}}}({sid:i,endpoint:h,handler:n,eventTypes:e.eventTypes,checkout:P}))}),Promise.resolve(d()).then(function(){return P})})}catch(e){return Promise.reject(e)}},e.redirect=function(e){var n=e.endpoint;i(r({sid:e.sid,endpoint:void 0===n?"https://checkout.dintero.com":n,language:e.language}))}});
//# sourceMappingURL=checkout-web-sdk.umd.js.map